<?php
/** @noinspection ALL */
/**
  * @author      Be Rebel - https://berebel.io
  * @copyright   ©2023 Stock Management Labs™
 */
 defined('ABSPATH') || die; use Atum\Components\AtumAdminNotices; use Atum\Components\AtumAdminModal; use Atum\Inc\Helpers; final class AddonsLoader { private $SOBMT = array('action_logs' => '1.1.5', 'export_pro' => '1.3.4', 'multi_inventory' => '1.5.0', 'product_levels' => '1.6.0', 'purchase_orders' => '0.0.1', 'stock_takes' => '0.0.1', 'pick_pack' => '0.0.1'); private $fUZ7c = []; private $aT1VT; public function __construct() { $this->aT1VT = defined('ATUM_DEBUG') && TRUE === \Atum\Addons\ATUM_DEBUG; add_action('after_setup_theme', array($this, 'load_addons'), 99); } public function load_addons() { goto xSNew; umFYF: kv3AM: goto Zr1yg; Zoifd: $AjshM = AtumAdminModal::get_instance([ATUM_SHORT_NAME . '-addons']); goto cjsCd; LZeUc: foreach ($magiK as $jQs1D => $yyIw1) { goto DrSCh; fafrq: $r73kY[$jQs1D]['extended'] = $VmGQp[$bzKHS]['extended'] ?? FALSE; goto NbpXV; UVNri: if (!$AGZRO) { goto tdgxT; } goto hdC2V; LISPG: $magiK[$jQs1D]['bootstrap'] = '__return_false'; goto ZToIP; hdC2V: $zjN8O = str_replace('_trial', '', $jQs1D); goto A9KzA; DrSCh: $AGZRO = strpos($jQs1D, '_trial') !== FALSE || strpos($yyIw1['basename'], 'trial') !== FALSE; goto UVNri; NbpXV: if ('now' === $r73kY[$jQs1D]['expires']) { goto P7bl8; } goto l3o3Z; Bifug: DtbrM: goto c8Ssz; dmM6l: fr870: goto WJRWr; EBghn: $bzKHS = strtolower($yyIw1['name']); goto tTLi3; vJSPX: $r73kY[$jQs1D]['key'] = $VmGQp[$bzKHS]['key']; goto fafrq; WJRWr: BBQ5_: goto VkHlJ; F82Sj: $LruUY = sprintf(__('The ATUM %s Trial could not be loaded because the full version is installed. Please, uninstall the full version first to use the trial.', ATUM_TEXT_DOMAIN), $yyIw1['name']); goto bgNGw; Qz9Es: $r73kY[$jQs1D] = $yyIw1; goto wYb3c; KviZ4: RNJz3: goto eErko; MaGVL: AtumAdminNotices::add_notice($LruUY . ' ' . sprintf(__('Click %1$shere%2$s to purchase the full version.', ATUM_TEXT_DOMAIN), '<a href="' . $yyIw1['addon_url'] . '" target="_blank">', '</a>'), 'error', FALSE, TRUE); goto MH6wp; yJfIx: goto HtvET; goto Bifug; A9KzA: if (!(isset($magiK[$zjN8O]) || !$this->aT1VT && !empty($gycIC[$zjN8O]['basename']) && file_exists(WP_PLUGIN_DIR . '/' . $gycIC[$zjN8O]['basename']))) { goto FmlTi; } goto F82Sj; am_Zp: $LruUY = sprintf(__('The ATUM %1$s Trial could not be loaded because its license is missing. Please, activate your trial from the %2$sadd-ons%3$s page.', ATUM_TEXT_DOMAIN), $yyIw1['name'], '<a href="' . add_query_arg('page', 'atum-addons', admin_url('admin.php')) . '">', '</a>'); goto UL_89; MH6wp: $magiK[$jQs1D]['bootstrap'] = '__return_false'; goto FXthF; ICClB: goto HtvET; goto KviZ4; qC3nH: $nQEPv++; goto ICClB; fesaC: P7bl8: goto AvYJL; vdvtE: O2qxp: goto MaGVL; gpZRL: $magiK[$jQs1D]['bootstrap'] = '__return_false'; goto a7W9E; UL_89: AtumAdminNotices::add_notice($LruUY, 'error', FALSE, TRUE); goto Vfqbd; bgNGw: AtumAdminNotices::add_notice($LruUY, 'error', FALSE, TRUE); goto LISPG; a7W9E: $nQEPv++; goto dmM6l; pdi4g: $jpKtJ = call_user_func($yyIw1['bootstrap']); goto ZN5CI; tTLi3: if (!(empty($VmGQp) || empty($VmGQp[$bzKHS]) || empty($VmGQp[$bzKHS]['key']))) { goto RNJz3; } goto am_Zp; VkHlJ: HtvET: goto flvpG; l3o3Z: $LruUY = sprintf(__('Your ATUM %1$s trial has expired on %2$s, and it has been disabled.', ATUM_TEXT_DOMAIN), $yyIw1['name'], date_i18n(get_option('date_format'), strtotime($VmGQp[$bzKHS]['expires']))); goto ciWSu; YDj1Z: FmlTi: goto EBghn; AvYJL: $LruUY = sprintf(__('Your ATUM %1$s trial has expired and it has been disabled.', ATUM_TEXT_DOMAIN), $yyIw1['name']); goto vdvtE; qCktq: if (!(!empty($yyIw1['bootstrap']) && is_callable($yyIw1['bootstrap']))) { goto BBQ5_; } goto pdi4g; MMrXR: goto HtvET; goto YDj1Z; ZToIP: $nQEPv++; goto MMrXR; eErko: if (!(empty($VmGQp[$bzKHS]['expires']) || strtotime($VmGQp[$bzKHS]['expires']) <= time())) { goto DtbrM; } goto Qz9Es; c8Ssz: tdgxT: goto qCktq; ciWSu: goto O2qxp; goto fesaC; Vfqbd: $magiK[$jQs1D]['bootstrap'] = '__return_false'; goto qC3nH; ZN5CI: if (!(!$jpKtJ && !empty($this->SOBMT[$jQs1D]) && version_compare($this->SOBMT[$jQs1D], $yyIw1['version'], '<'))) { goto fr870; } goto gpZRL; FXthF: $nQEPv++; goto yJfIx; wYb3c: $r73kY[$jQs1D]['expires'] = $VmGQp[$bzKHS]['expires'] ?? 'now'; goto vJSPX; flvpG: } goto PyjSJ; FjJkS: $VmGQp = \Atum\Addons\Addons::get_keys(); goto uHLQv; fIuxC: if (!($nQEPv > 0)) { goto kv3AM; } goto QIcNn; WrmII: RzNjI: goto fIuxC; yJKvc: if (empty($magiK)) { goto F6YXx; } goto EOLr9; EOLr9: $nQEPv = 0; goto F1pAn; iONTU: if (empty($r73kY)) { goto RzNjI; } goto Zoifd; uHLQv: $gycIC = \Atum\Addons\Addons::get_addons_paths(); goto LZeUc; F1pAn: $r73kY = []; goto FjJkS; Zr1yg: F6YXx: goto gJklD; xSNew: $magiK = \Atum\Addons\Addons::get_installed_addons(); goto yJKvc; cjsCd: $AjshM->add_modal('trial-expired', array('icon' => 'warning', 'title' => _n('ATUM trial license expired!', 'ATUM trial licenses expired!', count($r73kY), ATUM_TEXT_DOMAIN), 'showCancelButton' => FALSE, 'showConfirmButton' => FALSE, 'customClass' => ['container' => 'atum-trial-modal'], 'footer' => sprintf(__('Why are these add-ons expired and blocked? %1$sREAD INFO%2$s', ATUM_TEXT_DOMAIN), '&nbsp;<a href="https://stockmanagementlabs.crunch.help/" target="_blank">', '</a>')), Helpers::load_view_to_string('add-ons/expired-trials-modal', compact('expired_trials'))); goto WrmII; PyjSJ: LGoFm: goto iONTU; QIcNn: \Atum\Addons\Addons::set_installed_addons($magiK); goto umFYF; gJklD: } }
